#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥–æ—Ç–æ–≤–æ–π —Å–±–æ—Ä–∫–∏
echo "üöÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ production —Å–±–æ—Ä–∫–∏..."

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É frontend
cd frontend

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
npm ci

# –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç
echo "üî® –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..."
npm run build

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
cd ..

# –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—É—é —Å–±–æ—Ä–∫—É
echo "üßπ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π —Å–±–æ—Ä–∫–∏..."
rm -rf build/*

# –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–≤—É—é —Å–±–æ—Ä–∫—É
echo "üìã –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–±–æ—Ä–∫–∏..."
cp -r frontend/dist/* build/

# –î–æ–±–∞–≤–ª—è–µ–º –≤ Git
echo "üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Git..."
git add build/

# –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç
echo "üíæ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞..."
git commit -m "chore: –æ–±–Ω–æ–≤–ª–µ–Ω–∞ production —Å–±–æ—Ä–∫–∞ $(date '+%Y-%m-%d %H:%M:%S')"

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ GitHub
echo "‚òÅÔ∏è –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ GitHub..."
git push origin main

echo "‚úÖ –°–±–æ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –Ω–∞ Git!"
echo "üìÅ –ì–æ—Ç–æ–≤–∞—è —Å–±–æ—Ä–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ build/"
